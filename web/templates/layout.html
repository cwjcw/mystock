<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ title or '股票监控' }}</title>
    <style>
      body { font-family: -apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,'Noto Sans',sans-serif; margin: 2rem; }
      .container { max-width: 720px; margin: 0 auto; }
      .flash { padding: .5rem 1rem; border-radius: 4px; margin: .5rem 0; }
      .flash.error { background:#fdecea; color:#b10000; }
      .flash.success { background:#edf7ed; color:#1e4620; }
      label { display:block; margin:.5rem 0 .25rem; }
      input[type=text], input[type=password], textarea { width:100%; padding:.5rem; border:1px solid #ccc; border-radius:4px; }
      textarea { height: 220px; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, 'Liberation Mono', 'Courier New', monospace; }
      .actions { margin-top:1rem; }
      .btn { display:inline-block; padding:.5rem 1rem; border:1px solid #444; border-radius:4px; text-decoration:none; background:#f5f5f5; color:#222; }
      .nav { margin-bottom:1rem; }
      .nav a { margin-right:1rem; }
      code { background:#f2f2f2; padding:.2rem .35rem; border-radius:3px; }
      .trade-layout { display:flex; flex-wrap:wrap; gap:1.5rem; }
      .trade-form.compact { flex:1 1 220px; display:grid; grid-template-columns:repeat(auto-fit, minmax(150px, 1fr)); gap:.4rem .75rem; align-items:end; padding:.75rem; border:1px solid #ddd; border-radius:6px; background:#fafafa; }
      .trade-form .form-row { display:flex; flex-direction:column; gap:.25rem; }
      .trade-form .form-row label { font-size:.8rem; color:#555; }
      .trade-form .form-row.wide { grid-column:1 / -1; }
      .trade-form .actions { grid-column:1 / -1; }
      .trade-form.compact input, .trade-form.compact select { width:100%; }
      .history { flex: 1 1 420px; }
      .history table { width:100%; border-collapse:collapse; font-size:.85rem; }
      .history th, .history td { text-align:center; }
      .history-table td:nth-child(3), .history-table th:nth-child(3) { width:24%; }
      .history-meta { display:flex; justify-content:space-between; align-items:center; margin-bottom:.5rem; }
      .pagination { margin-top:.75rem; display:flex; gap:.75rem; align-items:center; }
      .table-actions { display:flex; gap:.5rem; justify-content:center; }
      .table-actions form { margin:0; }
      .table-actions .btn { padding:.35rem .6rem; }
      .pnl-form.range { display:flex; flex-wrap:wrap; gap:.5rem 1rem; align-items:flex-end; margin:1rem 0; }
      .pnl-form.range label { font-size:.85rem; color:#555; }
      .pnl-form.range input { padding:.4rem .5rem; }
      .profit-summary { display:flex; flex-wrap:wrap; gap:1rem; margin-bottom:1.5rem; }
      .profit-card { flex:1 1 220px; border:1px solid #ddd; border-radius:6px; padding:1rem; background:#fafafa; }
      .profit-card.small { flex:1 1 200px; }
      .profit-card ul { margin:.5rem 0 0 1rem; padding-left:0; }
      .profit-card li { margin:.25rem 0; }
      .profit-value { font-size:1.4rem; font-weight:600; margin:.25rem 0; }
      .muted { color:#666; font-size:.9rem; }
      .positions table { width:100%; border-collapse:collapse; font-size:.85rem; }
      .positions th, .positions td { text-align:center; }
      .initial-profit { margin:1.5rem 0; }
      .initial-form { display:flex; flex-wrap:wrap; gap:.5rem 1rem; align-items:flex-end; margin-bottom:.75rem; }
      .initial-form label { font-size:.85rem; color:#555; }
      .profit-positive { color:#1e7a1e; }
      .profit-negative { color:#c62828; }
    </style>
  </head>
  <body>
    <div class="container">
      <div class="nav">
        {% if current_user.is_authenticated %}
          你好，{{ current_user.username }} | <a href="{{ url_for('watchlist_view') }}">我的股票</a> | <a href="{{ url_for('trades_view') }}">交易记录</a> | <a href="{{ url_for('portfolio_view') }}">持仓与盈亏</a> | <a href="{{ url_for('logout') }}">退出</a>
        {% else %}
          <a href="{{ url_for('login') }}">登录</a> | <a href="{{ url_for('register') }}">注册</a>
        {% endif %}
      </div>
      {% for category, message in get_flashed_messages(with_categories=True) %}
        <div class="flash {{ category }}">{{ message }}</div>
      {% endfor %}
      {% block content %}{% endblock %}
    </div>
  </body>
  </html>
